{% load static %}
<div class="hero_area">
  <div class="bg-box">
    <img src="{% static 'home/images/hero-bg.jpg' %}" alt="">
  </div>
  <!-- header section strats -->
  <header class="header_section">
    <div class="container">
      <nav class="navbar navbar-expand-lg custom_nav-container ">
        <a class="navbar-brand" href="index.html">
          <span>
            Feane
          </span>
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class=""> </span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav  mx-auto ">
            <li class="nav-item active">
              <a class="nav-link" href="{% url 'home' %}">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'menu' %}">Menu</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'book' %}">Book Table</a>
            </li>
          </ul>
          <div class="user_option">
            <a href="{% url 'profile' %}" class="user_link">
              <i class="fa fa-user" aria-hidden="true"></i>
            </a>
            <a class="cart_link" href="{% url 'cart' %}">
              <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 456.029 456.029" style="enable-background:new 0 0 456.029 456.029;" xml:space="preserve">
                <g>
                  <g>
                    <path d="M345.6,338.862c-29.184,0-53.248,23.552-53.248,53.248c0,29.184,23.552,53.248,53.248,53.248
                 c29.184,0,53.248-23.552,53.248-53.248C398.336,362.926,374.784,338.862,345.6,338.862z" />
                  </g>
                </g>
                <g>
                  <g>
                    <path d="M439.296,84.91c-1.024,0-2.56-0.512-4.096-0.512H112.64l-5.12-34.304C104.448,27.566,84.992,10.67,61.952,10.67H20.48
                 C9.216,10.67,0,19.886,0,31.15c0,11.264,9.216,20.48,20.48,20.48h41.472c2.56,0,4.608,2.048,5.12,4.608l31.744,216.064
                 c4.096,27.136,27.648,47.616,55.296,47.616h212.992c26.624,0,49.664-18.944,55.296-45.056l33.28-166.4
                 C457.728,97.71,450.56,86.958,439.296,84.91z" />
                  </g>
                </g>
                <g>
                  <g>
                    <path d="M215.04,389.55c-1.024-28.16-24.576-50.688-52.736-50.688c-29.696,1.536-52.224,26.112-51.2,55.296
                 c1.024,28.16,24.064,50.688,52.224,50.688h1.024C193.536,443.31,216.576,418.734,215.04,389.55z" />
                  </g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
                <g>
                </g>
              </svg>
            </a>
<!--            <form class="form-inline">-->
<!--              <button class="btn  my-2 my-sm-0 nav_search-btn" type="submit">-->
<!--                <i class="fa fa-search" aria-hidden="true"></i>-->
<!--              </button>-->
<!--            </form>-->
              <form class="form-inline" id="search-form" method="GET" action="{% url 'search' %}">
                <div class="input-group">
                  <input id="search-input" class="form-control" type="text" name="q" placeholder="Search for dishes..." style="display: none;">
                  <div class="input-group-append">
                    <button class="btn my-2 my-sm-0 nav_search-btn" type="button" id="search-btn">
                      <i class="fa fa-search" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </form>


            <a href="" class="order_online">
              Order Online
            </a>
          </div>
        </div>
      </nav>
    </div>
  </header>
  <!-- end header section -->
  <!-- slider section -->
  <section class="slider_section ">
    <div id="customCarousel1" class="carousel slide" data-ride="carousel">
      <div class="carousel-inner">
        <div class="carousel-item active">
          <div class="container ">
            <div class="row">
              <div class="col-md-7 col-lg-6 ">
                <div class="detail-box">
                  <h1>
                    Fast Food Restaurant
                  </h1>
                  <p>
                    Doloremque, itaque aperiam facilis rerum, commodi, temporibus sapiente ad mollitia laborum quam quisquam esse error unde. Tempora ex doloremque, labore, sunt repellat dolore, iste magni quos nihil ducimus libero ipsam.
                  </p>
                  <div class="btn-box">
                    <a href="" class="btn1">
                      Order Now
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="carousel-item ">
          <div class="container ">
            <div class="row">
              <div class="col-md-7 col-lg-6 ">
                <div class="detail-box">
                  <h1>
                    Fast Food Restaurant
                  </h1>
                  <p>
                    Doloremque, itaque aperiam facilis rerum, commodi, temporibus sapiente ad mollitia laborum quam quisquam esse error unde. Tempora ex doloremque, labore, sunt repellat dolore, iste magni quos nihil ducimus libero ipsam.
                  </p>
                  <div class="btn-box">
                    <a href="" class="btn1">
                      Order Now
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="carousel-item">
          <div class="container ">
            <div class="row">
              <div class="col-md-7 col-lg-6 ">
                <div class="detail-box">
                  <h1>
                    Fast Food Restaurant
                  </h1>
                  <p>
                    Doloremque, itaque aperiam facilis rerum, commodi, temporibus sapiente ad mollitia laborum quam quisquam esse error unde. Tempora ex doloremque, labore, sunt repellat dolore, iste magni quos nihil ducimus libero ipsam.
                  </p>
                  <div class="btn-box">
                    <a href="" class="btn1">
                      Order Now
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <ol class="carousel-indicators">
          <li data-target="#customCarousel1" data-slide-to="0" class="active"></li>
          <li data-target="#customCarousel1" data-slide-to="1"></li>
          <li data-target="#customCarousel1" data-slide-to="2"></li>
        </ol>
      </div>
    </div>

  </section>



  <div id="chatbot-icon">üí¨</div>

  <!-- Chatbox -->
  <div id="chatbot-box" style="display: none;">
      <div class="header">H·ªó tr·ª£ tr·ª±c tuy·∫øn</div>
      <div class="messages" id="chat-messages">
          <!-- ƒê√¢y l√† n∆°i s·∫Ω hi·ªÉn th·ªã c√°c tin nh·∫Øn -->
          <p>Ch√†o qu√Ω kh√°ch, r·∫•t vui v√¨ qu√Ω kh√°ch ƒë√£ l·ª±a ch·ªçn d·ªãch v·ª• c·ªßa ch√∫ng t√¥i.</p>
          <p>Kh√¥ng bi·∫øt qu√Ω kh√°ch mu·ªën ƒë·∫∑t c√¢u h·ªèi n√†o cho c·ª≠a h√†ng?</p>
      </div>
      <div class="input-box">
          <input type="text" id="chat-input" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n...">
          <button id="send-message">G·ª≠i</button>
      </div>
  </div>

</div>

<script>
    // Hi·ªÉn th·ªã v√† ·∫©n khung chat khi click v√†o bi·ªÉu t∆∞·ª£ng chat
    const chatbotIcon = document.getElementById('chatbot-icon');
    const chatbotBox = document.getElementById('chatbot-box');

    chatbotIcon.addEventListener('click', function() {
        if (chatbotBox.style.display === 'none' || chatbotBox.style.display === '') {
            chatbotBox.style.display = 'block';
            loadMessages();  // T·∫£i tin nh·∫Øn khi m·ªü chatbox
        } else {
            chatbotBox.style.display = 'none';
        }
    });

    // X·ª≠ l√Ω khi g·ª≠i tin nh·∫Øn
    const sendMessageButton = document.getElementById('send-message');
    const chatInput = document.getElementById('chat-input');
    const chatMessages = document.getElementById('chat-messages');

    sendMessageButton.addEventListener('click', function() {
        const message = chatInput.value.trim();
        if (message) {
            const csrfToken = '{{ csrf_token }}';  // L·∫•y token CSRF
            fetch('/send_message/', {  // G·ªçi API ƒë·ªÉ g·ª≠i tin nh·∫Øn
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-CSRFToken': csrfToken
                },
                body: new URLSearchParams({
                    'message': message
                })
            })
            .then(response => {
                if (response.ok) {
                    chatInput.value = '';  // X√≥a n·ªôi dung trong input sau khi g·ª≠i
                    loadMessages();  // T·∫£i l·∫°i tin nh·∫Øn sau khi g·ª≠i
                }
            });
        }
    });

    // H√†m t·∫£i tin nh·∫Øn
    function loadMessages() {
        fetch('/load_chatbox/')  // G·ªçi API ƒë·ªÉ l·∫•y tin nh·∫Øn
            .then(response => response.json())
            .then(data => {
                chatMessages.innerHTML = '';  // X√≥a c√°c tin nh·∫Øn c≈©
                data.messages.forEach(msg => {
                    const newMessage = document.createElement('p');
                    newMessage.textContent = `${msg.sender}: ${msg.content}`;
                    chatMessages.appendChild(newMessage);
                });
                chatMessages.scrollTop = chatMessages.scrollHeight;  // T·ª± ƒë·ªông cu·ªôn xu·ªëng cu·ªëi
            });
    }

    // ƒê·ªãnh k·ª≥ t·∫£i tin nh·∫Øn m·ªõi
    setInterval(loadMessages, 5000);
</script>

